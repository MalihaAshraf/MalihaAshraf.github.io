<html>
<head>
<title>csf-castle-sla</title>

<script type="text/javascript">
function detectLeftButton(evt) {
    evt = evt || window.event;
    var button = evt.which || evt.button;
    return button == 1;
}
</script>
<link rel="stylesheet" type="text/css" href="style.css"></head>

<body>
<h1>Fitting of spatial CSF Gabor and Disc datasets</h1>
<h2>Fitting error</h2>
<TABLE>
<tr><td rowspan="2">Dataset</td>
<td colspan="6">Fitting error</td>
<td colspan="6">Sensitivity adjustment</td>
</tr>
<tr><td><a href="#castle-csf-jov">castleCSF-jov</a></td>
<td><a href="#stoBarten-Veridical">original Barten's spatiotemporal veridical CSF</a></td>
<td><a href="#daly-csf">VDP CSF</a></td>
<td><a href="#csf-jov">csf-jov</a></td>
<td><a href="#post-recept-contrast-mat">Postreceptoral contrast</a></td>
<td><a href="#stela-csf">stelaCSF</a></td>
<td><a href="#castle-csf-jov">castleCSF-jov</a></td>
<td><a href="#stoBarten-Veridical">original Barten's spatiotemporal veridical CSF</a></td>
<td><a href="#daly-csf">VDP CSF</a></td>
<td><a href="#csf-jov">csf-jov</a></td>
<td><a href="#post-recept-contrast-mat">Postreceptoral contrast</a></td>
<td><a href="#stela-csf">stelaCSF</a></td>
</tr>
<tr><td>Average training</td>
<td>2.98 &plusmn; 0.06 [dB]</td>
<td>3.46 &plusmn; 0.12 [dB]</td>
<td>6.44 &plusmn; 0.61 [dB]</td>
<td>3.37 &plusmn; 0.13 [dB]</td>
<td>2.58 &plusmn; 0.12 [dB]</td>
<td>3.02 &plusmn; 0.15 [dB]</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr><td>Average testing</td>
<td>3.22 &plusmn; 0.63 [dB]</td>
<td>3.58 &plusmn; 0.50 [dB]</td>
<td>8.00 &plusmn; 3.81 [dB]</td>
<td>3.56 &plusmn; 0.60 [dB]</td>
<td>3.09 &plusmn; 0.62 [dB]</td>
<td>3.20 &plusmn; 0.66 [dB]</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
<td>N/A</td>
</tr>
<tr><td><a href="#modelfest">modelfest</a></td>
<td>2.26 [dB]</td>
<td>2.41 [dB]</td>
<td>3.22 [dB]</td>
<td>2.84 [dB]</td>
<td>1.64 [dB]</td>
<td>2.54 [dB]</td>
<td>0.957</td>
<td>1.377</td>
<td>1.234</td>
<td>1.399</td>
<td>0.947</td>
<td>1.371</td>
</tr>
<tr><td><a href="#hdrvdp_csf">hdrvdp_csf</a></td>
<td>2.27 [dB]</td>
<td>3.91 [dB]</td>
<td>8.42 [dB]</td>
<td>2.57 [dB]</td>
<td>2.00 [dB]</td>
<td>3.01 [dB]</td>
<td>1.150</td>
<td>1.767</td>
<td>3.020</td>
<td>1.674</td>
<td>1.102</td>
<td>1.685</td>
</tr>
<tr><td><a href="#rovamo1993">rovamo1993</a></td>
<td>3.79 [dB]</td>
<td>2.78 [dB]</td>
<td>6.36 [dB]</td>
<td>4.35 [dB]</td>
<td>2.88 [dB]</td>
<td>3.08 [dB]</td>
<td>1.747</td>
<td>2.743</td>
<td>4.877</td>
<td>2.399</td>
<td>1.623</td>
<td>2.282</td>
</tr>
<tr><td><a href="#virsu1979">virsu1979</a></td>
<td>4.29 [dB]</td>
<td>4.13 [dB]</td>
<td>3.90 [dB]</td>
<td>5.30 [dB]</td>
<td>4.49 [dB]</td>
<td>3.95 [dB]</td>
<td>1.704</td>
<td>2.240</td>
<td>3.755</td>
<td>1.891</td>
<td>1.463</td>
<td>1.862</td>
</tr>
<tr><td><a href="#wright1983">wright1983</a></td>
<td>1.30 [dB]</td>
<td>2.21 [dB]</td>
<td>3.03 [dB]</td>
<td>1.58 [dB]</td>
<td>0.85 [dB]</td>
<td>1.77 [dB]</td>
<td>1.040</td>
<td>1.476</td>
<td>1.589</td>
<td>1.457</td>
<td>1.055</td>
<td>1.313</td>
</tr>
<tr><td><a href="#colorfest">colorfest</a></td>
<td>2.54 [dB]</td>
<td>2.81 [dB]</td>
<td>2.68 [dB]</td>
<td>3.38 [dB]</td>
<td>2.08 [dB]</td>
<td>2.98 [dB]</td>
<td>0.940</td>
<td>0.951</td>
<td>1.204</td>
<td>0.976</td>
<td>0.971</td>
<td>0.909</td>
</tr>
<tr><td><a href="#hdr_csf">hdr_csf</a></td>
<td>3.32 [dB]</td>
<td>3.91 [dB]</td>
<td>5.81 [dB]</td>
<td>3.67 [dB]</td>
<td>3.12 [dB]</td>
<td>3.33 [dB]</td>
<td>1.000</td>
<td>1.000</td>
<td>1.000</td>
<td>1.000</td>
<td>1.000</td>
<td>1.000</td>
</tr>
<tr><td><a href="#hdr_csf_disc">hdr_csf_disc</a></td>
<td>2.15 [dB]</td>
<td>1.56 [dB]</td>
<td>1.12 [dB]</td>
<td>1.84 [dB]</td>
<td>2.06 [dB]</td>
<td>1.37 [dB]</td>
<td>1.169</td>
<td>1.191</td>
<td>1.154</td>
<td>1.215</td>
<td>1.186</td>
<td>0.895</td>
</tr>
</TABLE>
<h2>Model comparison statistics</h2>
<TABLE>
<tr><td rowspan="2" colspan="1">Model</td>
<td rowspan="2" colspan="1">Sum of Square Errors (SS)</td>
<td rowspan="2" colspan="1">Degrees of freedom (df)</td>
<td colspan="2">F-test</td>
<td rowspan="2" colspan="1">AIC</td>
</tr>
<tr><td>F-statistic</td>
<td>p-value</td>
</tr>
<tr><td><a href="#castle-csf-jov">castleCSF-jov (Reference Model)</a></td>
<td>5.476</td>
<td>171</td>
<td>N/A</td>
<td>N/A</td>
<td>-755.4</td>
</tr>
<tr><td><a href="#stoBarten-Veridical">original Barten's spatiotemporal veridical CSF</a></td>
<td>7.176</td>
<td>215</td>
<td>1.20587</td>
<td>0.1004</td>
<td>-779.893</td>
</tr>
<tr><td><a href="#daly-csf">VDP CSF</a></td>
<td>25.800</td>
<td>222</td>
<td>12.4435</td>
<td>0.0000 &check;</td>
<td>-493.162</td>
</tr>
<tr><td><a href="#csf-jov">csf-jov</a></td>
<td>6.862</td>
<td>201</td>
<td>1.44244</td>
<td>0.0069 &check;</td>
<td>-762.386</td>
</tr>
<tr><td><a href="#post-recept-contrast-mat">Postreceptoral contrast</a></td>
<td>4.136</td>
<td>197</td>
<td>-1.60919</td>
<td>1.0000</td>
<td>-873.341</td>
</tr>
<tr><td><a href="#stela-csf">stelaCSF</a></td>
<td>5.499</td>
<td>207</td>
<td>0.0195453</td>
<td>1.0000</td>
<td>-826.435</td>
</tr>
</TABLE>
<p>
We use AIC and F-test to test whether the difference in fitting error is statistically significant at alpha=0.05 level. Both statistical metrics take the number of optimized parameters into account. 
</p>

<p>
<b>F-test</b>: For F-test, we compare the fitting results from caslteCSF with those of other models. The F-static is calculated using the residual sum of squares and degrees of freedom (number of data points - number of optimized parameters) from both models. The corresponding p-value indicates whether or not the null hypothesis is rejected, where H<sub>0</sub>: the castleCSF does not provide significant better fit than the other model. The p-values less than 0.05 indicates that castleCSF provides a better fit to the data at the significance level of 0.05 (marked with &check;). We performed the F-test for all individual datasets as well as for all datasets combined. For smaller datasets, where the number of data points are comparable to the number of model parameters, F-test can not provide any results since it indicates there is more variance within the models' fits than between.  
</p>

<p>
<b>AIC</b>: Akaike information criterion is a statistical estimator of prediction error and relative quality of the models, which accounts for the number of parameters of each model. 
The model with the lower AIC score is considered to be better and with a good balance of error value and the number of parameters.  
</p>

<p>
The sensitivity adjustment column contains a multiplier that is used to adjust the sensitivity of each datasets. It corresponds to <i>s<sub>d</sub></i> in the paper (Eq. 18).
</p>
<h2>Model parameters</h2>
<div class="params_frame">
<div align="center">castleCSF-jov</div>
<div style="white-space: pre-line;">

M_lms2acc =

    1.0000    1.0000         0
    1.0000   -2.1515         0
   -1.0000   -1.0000   49.9340

	p.rg.sigma_sust = 16.541;
	p.rg.beta_sust = 1.15549;
	p.rg.ch_sust.S_max = [ 1317.78 0.342018 0.367998 ];
	p.rg.ch_sust.f_max = 0.122965;
	p.rg.ch_sust.bw = 0.424147;
	p.rg.A_0 = 256.928;
	p.rg.f_0 = 32.4658;
	p.rg.ecc_drop = 0.0591431;
	p.rg.ecc_drop_nasal = 2.89648e-05;
	p.rg.ecc_drop_f = 2.04986e-69;
	p.rg.ecc_drop_f_nasal = 0.180118;
	p.yv.sigma_sust = 7.9187;
	p.yv.beta_sust = 0.999363;
	p.yv.ch_sust.S_max = [ 64.1982 62.9917 0.411333 ];
	p.yv.ch_sust.f_max = 0.00220293;
	p.yv.ch_sust.bw = 0.532509;
	p.yv.A_0 = 2.81672e+07;
	p.yv.f_0 = 0.000630084;
	p.yv.ecc_drop = 0.00357397;
	p.yv.ecc_drop_nasal = 5.85804e-141;
	p.yv.ecc_drop_f = 0.0080878;
	p.yv.ecc_drop_f_nasal = 0.0147658;
	p.ach.ach_sust.S_max = [ 77.1236 0.470503 0.429523 4.22703e-07 1.92855e+10 ];
	p.ach.ach_sust.f_max = [ 1.3741 58.8829 0.226072 ];
	p.ach.ach_sust.bw = 0.000206379;
	p.ach.ach_sust.a = 9.62791e+14;
	p.ach.ach_sust.A_0 = 5.85361;
	p.ach.ach_sust.f_0 = 4.20042;
	p.ach.ach_trans.S_max = [ 0.262965 2084.81 ];
	p.ach.ach_trans.f_max = 0.000275027;
	p.ach.ach_trans.bw = 1.18228;
	p.ach.ach_trans.a = 0.000241177;
	p.ach.ach_trans.A_0 = 2.18495;
	p.ach.ach_trans.f_0 = 2.76283;
	p.ach.sigma_trans = 0.0246245;
	p.ach.sigma_sust = 10.467;
	p.ach.omega_trans_sl = 25.249;
	p.ach.omega_trans_c = 0.692533;
	p.ach.ecc_drop = 0.0259781;
	p.ach.ecc_drop_nasal = 0.0452708;
	p.ach.ecc_drop_f = 0.0217926;
	p.ach.ecc_drop_f_nasal = 0.0068348;
	p.colmat = [ 2.15154 0 0 49.934 ];
Parameters for Ach component:
	p.ach_sust.S_max = [ 77.1236 0.470503 0.429523 4.22703e-07 1.92855e+10 ];
	p.ach_sust.f_max = [ 1.3741 58.8829 0.226072 ];
	p.ach_sust.bw = 0.000206379;
	p.ach_sust.a = 9.62791e+14;
	p.ach_trans.S_max = [ 0.262965 2084.81 ];
	p.ach_trans.f_max = 0.000275027;
	p.ach_trans.bw = 1.18228;
	p.ach_trans.a = 0.000241177;
	p.ach_trans.A_0 = 2.18495;
	p.ach_trans.f_0 = 2.76283;
	p.sigma_trans = 0.0246245;
	p.sigma_sust = 10.467;
	p.omega_trans_sl = 25.249;
	p.omega_trans_c = 0.692533;
	p.ecc_drop = 0.0259781;
	p.ecc_drop_nasal = 0.0452708;
	p.ecc_drop_f = 0.0217926;
	p.ecc_drop_f_nasal = 0.0068348;

Parameters for RG component:
				p.ch_sust.S_max = [ 1317.78 0.342018 0.367998 ];
				p.ch_sust.f_max = 0.122965;
				p.ch_sust.bw = 0.424147;
				p.A_0 = 256.928;
				p.f_0 = 32.4658;
				p.sigma_sust = 16.541;
				p.beta_sust = 1.15549;
				p.ecc_drop = 0.0591431;
				p.ecc_drop_nasal = 2.89648e-05;
				p.ecc_drop_f = 2.04986e-69;
				p.ecc_drop_f_nasal = 0.180118;

Parameters for YV component:
				p.ch_sust.S_max = [ 64.1982 62.9917 0.411333 ];
				p.ch_sust.f_max = 0.00220293;
				p.ch_sust.bw = 0.532509;
				p.A_0 = 2.81672e+07;
				p.f_0 = 0.000630084;
				p.sigma_sust = 7.9187;
				p.beta_sust = 0.999363;
				p.ecc_drop = 0.00357397;
				p.ecc_drop_nasal = 5.85804e-141;
				p.ecc_drop_f = 0.0080878;
				p.ecc_drop_f_nasal = 0.0147658;

</div>
</div>
<div class="params_frame">
<div align="center">original Barten's spatiotemporal veridical CSF</div>
<div style="white-space: pre-line;">
	p.k = 7.50783;
	p.eta0 = 0.0540745;
	p.sigma0 = 0.268369;
	p.eg = 3.3;
	p.u00 = 3.34419;
	p.Phi00 = 3e-08;
	p.T = 0.0632125;
	p.Xmax0 = 15.0242;
	p.Nmax = 5.85972;
	p.tau10 = 0.032;
	p.tau20 = 0.018;
	p.n1 = 7;
	p.n2 = 4;
</div>
</div>
<div class="params_frame">
<div align="center">VDP CSF</div>
<div style="white-space: pre-line;">
	p.P = 154.194;
	p.ob = 1.3868;
	p.k = 0.24;
	p.epsilon = 1.11381;
	p.a_l_m = 2.91073;
	p.b_l_m = 78.1072;
</div>
</div>
<div class="params_frame">
<div align="center">csf-jov</div>
<div style="white-space: pre-line;">
	p.ach.S_max = [ 2.84078 1.34534 41.84 ];
	p.ach.f_max = [ 227448 64.5407 305.751 ];
	p.ach.bw = 1.56902;
	p.ach.Ac_prime = 116.028;
	p.ach.f_0 = 5.38583;
	p.ach.gamma = 0.90634;
	p.rg.S_max = [ 2.90539 3.04331 38.6588 ];
	p.rg.f_max = [ 0.0686226 3.04969e-24 ];
	p.rg.bw = 1.21802;
	p.rg.Ac_prime = 18.6192;
	p.rg.f_0 = 0.65;
	p.rg.gamma = 1.24219;
	p.yv.S_max = [ 2.19857 3.04952 23.8802 ];
	p.yv.f_max = 0.121887;
	p.yv.bw = 2.91534;
	p.yv.Ac_prime = 2.12076;
	p.yv.f_0 = 0.65;
	p.yv.gamma = 1.35274;
</div>
</div>
<div class="params_frame">
<div align="center">Postreceptoral contrast</div>
<div style="white-space: pre-line;">
	p.ach.S_max = [ 676.159 0.63811 0.416629 15489.1 0.957643 ];
	p.ach.f_max = [ 1.4336 59.5397 0.221623 ];
	p.ach.bw = 1.06991e-07;
	p.ach.gamma = 0.909082;
	p.ach.Ac_prime = 101.041;
	p.rg.S_max = [ 22269.7 0.329602 0.383617 ];
	p.rg.f_max = 0.0826806;
	p.rg.bw = 0.94352;
	p.rg.gamma = 1.34102;
	p.rg.Ac_prime = 86.2466;
	p.yv.S_max = [ 12184.8 66.2122 0.355583 ];
	p.yv.f_max = 0.00097508;
	p.yv.bw = 0.112307;
	p.yv.gamma = 1.39713;
	p.yv.Ac_prime = 0.287547;
	p.colmat = [ 0.135061 1.48126e-09 2.49217 0.00221276 3.89116e-06 1.99426 ];
</div>
</div>
<div class="params_frame">
<div align="center">stelaCSF</div>
<div style="white-space: pre-line;">
	p.ach_sust.S_max = [ 44.877 1.6509 0.297534 7.54866e-07 8.93101e+09 ];
	p.ach_sust.f_max = [ 1.51832 82.7359 0.207597 ];
	p.ach_sust.bw = 2.98722e-09;
	p.ach_sust.a = 0.127009;
	p.ach_trans.S_max = [ 0.0643615 36.7276 ];
	p.ach_trans.f_max = 0.0190447;
	p.ach_trans.bw = 1.0085;
	p.ach_trans.a = 0.000273289;
	p.sigma_trans = 0.000154977;
	p.sigma_sust = 5.79336;
	p.ecc_drop = 0.0296662;
	p.ecc_drop_nasal = 0.0113638;
	p.ecc_drop_f = 0.0190062;
	p.ecc_drop_f_nasal = 0.0193858;
</div>
</div>
<h2>Legend</h2>
<p>To keep the plots legible, only up to 3 models are plotted.</p>
<img src="legend.png"/>
<h2 id="modelfest"><a class="top_align_button" href="#modelfest">&#8632;</a>Dataset: [modelfest] ModelFest</h2>
<div>Achromatic CSF as a function of frequency<br/>
<img src="fig_modelfest_1.png"/>
<br/></div>
<h2 id="hdrvdp_csf"><a class="top_align_button" href="#hdrvdp_csf">&#8632;</a>Dataset: [hdrvdp_csf] HDR-VDP CSF</h2>
<div>Achromatic CSF as a function of frequency<br/>
<img src="fig_hdrvdp_csf_1.png"/>
<br/></div>
<div>Achromatic CSF as a function of size<br/>
<img src="fig_hdrvdp_csf_2.png"/>
<br/></div>
<h2 id="rovamo1993"><a class="top_align_button" href="#rovamo1993">&#8632;</a>Dataset: [rovamo1993] Rovamo et al. 1993</h2>
<div>CSF as the funcation of stimulus area<br/>
<img src="fig_rovamo1993_1.png"/>
<br/></div>
<h2 id="virsu1979"><a class="top_align_button" href="#virsu1979">&#8632;</a>Dataset: [virsu1979] Virsu & Rovamo 1979</h2>
<div>Contrast sensitivity of central and peripheral vision as a function of spatial frequency and eccentricity<br/>
<img src="fig_virsu1979_1.png"/>
<br/></div>
<h2 id="wright1983"><a class="top_align_button" href="#wright1983">&#8632;</a>Dataset: [wright1983] Wright and Johnson 1983</h2>
<div>CSF as function of eccentricity<br/>
<img src="fig_wright1983_1.png"/>
<br/></div>
<h2 id="colorfest"><a class="top_align_button" href="#colorfest">&#8632;</a>Dataset: [colorfest] ColorFest</h2>
<div>Chromatic CSF as a function of frequency<br/>
<img src="fig_colorfest_1.png"/>
<br/></div>
<h2 id="hdr_csf"><a class="top_align_button" href="#hdr_csf">&#8632;</a>Dataset: [hdr_csf] High Dynamic Range CSF</h2>
<div>CSF as the function of frequency at different luminance levels (fixed number of cycles)<br/>
<img src="fig_hdr_csf_1.png"/>
<br/></div>
<div>CSF for different number of cycles<br/>
<img src="fig_hdr_csf_2.png"/>
<br/></div>
<h2 id="hdr_csf_disc"><a class="top_align_button" href="#hdr_csf_disc">&#8632;</a>Dataset: [hdr_csf_disc] High Dynamic Range Disc CSF</h2>
<div>CSF as the function of size at different luminance levels<br/>
<img src="fig_hdr_csf_disc_1.png"/>
<br/></div>
</body>
</html>
